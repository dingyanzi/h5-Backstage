<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/main.css" />
		<link rel="stylesheet" type="text/css" href="css/animate.min.css" />
		<link rel="stylesheet" type="text/css" href="css/iconfont.css" />
		<link rel="stylesheet" type="text/css" href="css/reset.css" />
		<link rel="stylesheet" type="text/css" href="layer/theme/default/layer.css" />
		<link rel="stylesheet" type="text/css" href="dist/css/swiper.min.css">
		<link rel="stylesheet" type="text/css" href="layui/css/layui.css" />
	</head>
	<style type="text/css">
		.layui-elem-quote {
			background: none;
			width: 370px;
			float: left
		}
		
		.layui-colorpicker {
			padding: 0;
			width: 35px;
		}
		
		.layui-elem-field legend {
			font-size: 18px;
			color: #333;
			font-weight: bold;
		}
		
		.layui-field-title {
			margin: 25px 0;
		}
		
		.layui-colla-item {
			border: none;
		}
		
		.layui-colla-title {
			padding: 0 25px;
		}
		
		.layui-colla-title .layui-colla-icon {
			right: 15px;
			left: inherit;
		}
		
		.layui-form-label,
		.groupBox label {
			width: auto !important;
			padding: 9px 10px !important;
		}
		
		.layui-slider-input {
			top: -14px
		}
		
		.xhBtn .layui-form-item .layui-form-checkbox[lay-skin=primary] {
			margin-top: 17px;
		}
		
		.phoneBox .swiper-button-next {
			right: -50px;
		}
		
		.phoneBox .swiper-button-prev {
			left: -50px !important;
		}
		
		#mapcontent,
		#mapshowcontent {
			width: 150px;
			height: 150px;
		}
		
		.layui-colla-content {
			padding: 20px 15px;
		}
		
		.showPhoneBox .swiper-button-prev,
		.showPhoneBox .swiper-button-next {
			left: inherit;
			right: -32px;
			background: #2096f9;
			font-size: 12px;
			text-align: center;
			opacity: 1;
			height: 64px;
			color: #fff;
			padding: 3px 7px;
			top: 24%;
			border-radius: 0 6px 6px 0;
			cursor: pointer;
		}
		
		.showPhoneBox .swiper-button-next {
			top: 39%;
		}
	</style>

	<body class="layui-layout-body">
		<div class="layui-layout layui-layout-admin">
			<div class="layui-header">
				<div class="layui-logo">layui 后台布局</div>
			</div>
			<div class="layui-side layui-bg-black">
				<div class="layui-side-scroll">
					<!-- 左侧导航区域（可配合layui已有的垂直导航） -->
					<ul class="layui-nav layui-nav-tree">
						<li class="layui-nav-item layui-nav-itemed">
							<a class="" href="javascript:;">所有商品</a>
							<dl class="layui-nav-child">
								<dd>
									<a href="javascript:;">列表一</a>
								</dd>
								<dd>
									<a href="javascript:;">列表二</a>
								</dd>
								<dd>
									<a href="javascript:;">列表三</a>
								</dd>
								<dd>
									<a href="">超链接</a>
								</dd>
							</dl>
						</li>
					</ul>
				</div>
			</div>

			<!-- 内容主体区域 -->
			<div class="layui-body" style="bottom: 0;border-left: solid 2px #1AA094;">
				<div class="creat_head">

					<div class="creat_con">
						<div class="topBtn">
							<a href="javascript:void(0);" class="layui-btn layui-btn-small" name="back">
								<i class="layui-icon"></i> 返回
							</a>
							<a onclick="showModel()" href="javascript:void(0);" class="layui-btn layui-btn-small" name="generateImage">
								<i class="layui-icon">စ</i> 预览
							</a>
							<a id="saveFn" href="javascript:void(0);" class="layui-btn layui-btn-small" lay-submit="" lay-filter="templateSubmit">
								<i class="layui-icon">စ</i> 保存
							</a>
						</div>
						<ul class="comp_panel cc">
							<li id="addText">
								<i class="icon iconfont icon-wenben"></i>
								<span>文本</span>
							</li>
							<li>
								<input id="Fileimg" type="file" />
								<i class="icon iconfont icon-tupian"></i>
								<span>图片</span>
							</li>
							<li>
								<i class="icon iconfont icon-background"></i>
								<span>背景</span>
								<dl class="navBox">
									<img id="jiao" src="images/san.png" />
									<dd class="cc">
										<div class="flex">
											<label>上传背景图</label>
											<button class="layui-btn layui-btn-primary  layui-btn-sm"><input id="Filebg" type="file" />点击上传</button>
											<button onclick="removeBgimg()" class="layui-btn layui-btn-primary  layui-btn-sm">删除背景</button>
										</div>
									</dd>
									<dd class="cc">
										<div class="flex">
											<label>背景颜色</label>
											<div>
												<input type="hidden" name="color" value="" id="bgimgColor">
												<div id="bgimgColor-id"></div>
											</div>
										</div>
									</dd>
								</dl>
							</li>
							<li onclick="addMusic()">
								<i class="icon iconfont icon-yinle"></i>
								<span>音乐</span>
							</li>
							<li onclick="addMap()">
								<i class="icon iconfont icon-ditumap31"></i>
								<span>地图</span>
							</li>
							<li>
								<i class="icon iconfont icon-form"></i>
								<span>表单</span>
								<dl class="navBox formico">
									<img id="jiao" src="images/san.png" />
									<dd class="cc">
										<div onclick="formidA()" class="flex">
											<label>联系人</label>
											<i class="icon iconfont icon-lianxiren"></i>
										</div>
									</dd>
									<dd class="cc">
										<div onclick="formidB()" class="flex">
											<label>文本框</label>
											<i style="font-size: 20px;margin-left: 4px;" class="icon iconfont icon-shuruxiugai"></i>
										</div>
									</dd>
								</dl>
							</li>
							<li onclick="addPage()">
								<i class="icon iconfont icon-yemian"></i>
								<span>+页面</span>
							</li>
							<li onclick="addCover()">
								<i class="icon iconfont icon-morenfengmiantu"></i>
								<span>封面</span>
							</li>
						</ul>

					</div>
				</div>
				<div class="creat_content cc">
					<div class="canvasBox">
						<div class="phoneWrap">
							<div class="phoneBox" id="tar">
								<div class="swiper-container">
									<div class="swiper-wrapper">
										<section class="swiper-slide">
										</section>
									</div>
									<div class="swiper-pagination" style="color: #000;"></div>
								</div>
								<menu id="menu">
									<ul>
										<li id="btn1">删除</li>
										<li id="btn2">置顶</li>
										<li id="btn3">置底</li>
										<li id="btn4">上移</li>
										<li id="btn5">下移</li>
									</ul>
								</menu>
								<div class="swiper-button-prev"></div>
								<div class="swiper-button-next"></div>
							</div>
						</div>
					</div>
					<div class="operationBox">
						<ul class="rightSet cc">
							<li class="on">
								<a href="javascript:;">样式</a>
							</li>
							<li>
								<a href="javascript:;">动画</a>
							</li>
						</ul>
						<div class="rightSetBox cc">
							<div class="style_list_txt">
								<div class="lineBox cc" style="line-height: 36px;">
									<label>字号</label>14px
									<div class="func-btns">
										<a id="fontBig" href="javascript:;">A+</a>
										<a id="fontSmall" href="javascript:;">A-</a>
									</div>
								</div>
								<div class="lineBox flex cc">
									<div class="flex-1">
										<label style="line-height: 28px;">文字颜色</label>
										<div>
											<input type="hidden" name="color" value="" id="textColor">
											<div id="textColor-id"></div>
										</div>
									</div>
									<div class="flex-1">
										<label style="line-height: 28px;">背景颜色</label>
										<div>
											<input type="hidden" name="color" value="" id="bgColor">
											<div id="bgColor-id"></div>
										</div>
									</div>
								</div>
								<div class="lineBox cc">
									<label>行高</label>
									<div id="slideTest8" class="demo-slider"></div>
								</div>
								<div class="lineBox cc">
									<label>字距</label>
									<div id="slideTest9" class="demo-slider"></div>
								</div>
								<div class="lineBox fontBtn cc flex">
									<div class="text-alginBox">
										<a href="javascript:;" data-class="txtL" id="txtL-id" onmouseover="txtLFn('txtL-id')"> <i class="icon iconfont icon-icon--1"></i></a>
										<a href="javascript:;" data-class="txtC" id="txtC-id" onmouseover="txtCFn('txtC-id')"> <i class="icon iconfont icon-icon--"></i></a>
										<a href="javascript:;" data-class="txtR" id="txtR-id" onmouseover="txtRFn('txtR-id')"> <i class="icon iconfont icon-youduiqi"></i></a>
									</div>
									<div class="text-style">
										<a href="javascript:;" id="txtBold-id" onmouseover="txtBoldFn('txtBold-id')"> <i class="icon iconfont icon-jiacu"></i></a>
										<a href="javascript:;" id="txtFontStyle-id" onmouseover="txtFontStyleFn('txtFontStyle-id')"> <i class="icon iconfont icon-704bianjiqi_Ixieti"></i></a>
										<a href="javascript:;" id="txtLineFn-id" onmouseover="txtLineFn('txtLineFn-id')"> <i class="icon iconfont icon-Underline"></i></a>
									</div>
									<div>
										<a href="javascript:;" id="txtClearFn-id" onmouseover="txtClearFn('txtClearFn-id')"> <i class="icon iconfont icon-yunongtongqingchuhuancun"></i></a>
									</div>
								</div>
							</div>
							<div class="style_list_img layui-collapse">
								<div class="layui-colla-item">
									<h2 class="layui-colla-title">图片</h2>
									<div class="layui-colla-content layui-show cc">
										<div class="image-preview">
										</div>
										<div class="image-btn">
											<div style="margin-bottom: 5px;"><button style="position: relative;padding:0 21px" class="layui-btn layui-btn-primary"> <input id="changeImgUrl_Id" type="file">更换图片</button></div>
											<div class="flex">
												<label style="margin-right: 5px;line-height: 27px" class="flex-1">背景颜色</label>
												<div class="flex-1">
													<input type="hidden" name="color" value="" id="imgColor">
													<div id="imgColor-id"></div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>

							<div class="style_list_map layui-collapse">
								<div class="layui-colla-item">
									<h2 class="layui-colla-title">地图</h2>
									<div class="layui-colla-content layui-show">
										<div style="width:253px;height:152px" id="mapcontainer"></div>
										<div class="searchMap layui-input-block">
											<input id="address" type="text" name="title" autocomplete="off" value="北京" class="layui-input">
											<i class="icon iconfont icon-sousuo" onclick="codeAddress()"></i>
										</div>
									</div>
								</div>
							</div>
							<fieldset class="layui-elem-field layui-field-title">
								<legend>功能设置</legend>
							</fieldset>
							<div class="layui-collapse">
								<div class="layui-colla-item">
									<h2 class="layui-colla-title">边框</h2>
									<div class="layui-colla-content layui-show">
										<div class="layui-form">
											<div class="layui-form-item">
												<label class="layui-form-label">边框样式</label>
												<div class="layui-input-block">
													<select name="interest" lay-filter="borderFn">
														<option value="0">---无---</option>
														<option value="1">直线</option>
														<option value="2">破折线</option>
														<option value="3">点状线</option>
														<option value="4">双划线</option>
													</select>
												</div>
											</div>
										</div>
										<div class="groupBox flex">
											<label>边框颜色</label>
											<div style="margin: 3px 0 0 34px;">
												<input type="hidden" name="color" value="" id="borderColor">
												<div id="borderColor-id"></div>
											</div>
										</div>
										<div class="groupBox flex">
											<label>边框尺寸</label>
											<div id="slideTest10" class="demo-slider"></div>
										</div>
										<div class="groupBox flex">
											<label>边框弧度</label>
											<div id="slideTest11" class="demo-slider"></div>
										</div>
									</div>
								</div>
								<div class="layui-colla-item">
									<h2 class="layui-colla-title">旋转与透明</h2>
									<div class="layui-colla-content layui-show">
										<div class="lineBox flex">
											<label>旋转</label>
											<div id="slideTest12" class="demo-slider"></div>
										</div>
										<div class="lineBox flex">
											<label>透明度</label>
											<div id="slideTest13" class="demo-slider"></div>
										</div>
									</div>
								</div>

							</div>
						</div>
						<div class="rightSetBox cc" style="display: none">
							<div class="lineBox flex cc" style="border-bottom: 1px solid #ccd5db;padding-bottom: 20px;">
								<button id="addCar" class="layui-btn"><i class="icon iconfont icon-jia"></i>添加动画</button>
								<button id="removeCar" class="layui-btn layui-btn-primary"><i class="icon iconfont icon-shanchu"></i>删除动画</button>
							</div>
							<div class="lineBox cc">
								<div class="actBox">
									<div class="animateBtn ">
										<label>时间</label>
										<input id="setTime" class="layui-input" type="number" step="0.1" min="0" max="20" value="1">
									</div>
									<div class="animateBtn ">
										<label>延迟</label>
										<input id="setDelay" class="layui-input" type="number" step="0.1" min="0" max="20" value="0">
									</div>
									<div class="xhBtn layui-form">
										<div class="layui-form-item" id="testB" style="margin-bottom: 0;">
											<div class="layui-input-block" style="margin-left: 0;min-height: 37px;">
												<input id="ifcheckbox" type="checkbox" name="like1[write]" lay-skin="primary" title="是否循环">
											</div>
										</div>
									</div>
									<button id="showCar" style="float: right;margin-top: 5px;" class="layui-btn layui-btn-primary"><i class="icon iconfont icon-bofang"></i>预览动画</button>
								</div>

								<ul class="anim-list transition">
									<a href="javascript:;" id="outAnim">退出</a>
									<li data-class="fadeIn">
										<div></div>
										<span>淡入</span>
									</li>
									<li data-class="flip">
										<div></div>
										<span>翻转</span>
									</li>
									<li data-class="fadeInLeft">
										<div></div>
										<span>向右移入</span>
									</li>
									<li data-class="fadeInRight">
										<div></div>
										<span>向左移入</span>
									</li>
									<li data-class="fadeInUp">
										<div></div>
										<span>向上移入</span>
									</li>
									<li data-class="fadeInDown">
										<div></div>
										<span>向下移入</span>
									</li>
									<li data-class="flipInX">
										<div></div>
										<span>翻转进入</span>
									</li>
									<li data-class="bounceInLeft">
										<div></div>
										<span>向右弹入</span>
									</li>
									<li data-class="bounceInRight">
										<div></div>
										<span>向左弹入</span>
									</li>
									<li data-class="bounceInDown">
										<div></div>
										<span>向上弹入</span>
									</li>
									<li data-class="bounceInUp">
										<div></div>
										<span>向下弹入</span>
									</li>
									<li data-class="flipInY">
										<div></div>
										<span>翻开进入</span>
									</li>
									<li data-class="rotateInUpRight">
										<div></div>
										<span>向右翻滚</span>
									</li>
									<li data-class="rotateInUpLeft">
										<div></div>
										<span>向左翻滚</span>
									</li>
									<li data-class="bounceIn">
										<div></div>
										<span>中心弹入</span>
									</li>
									<li data-class="bounceInLeft">
										<div></div>
										<span>光速向右</span>
									</li>
									<li data-class="bounceInRight">
										<div></div>
										<span>光速向左</span>
									</li>
									<li data-class="zoomIn">
										<div></div>
										<span>中心放大</span>
									</li>
									<li data-class="shake">
										<div></div>
										<span>摇摆</span>
									</li>
									<li data-class="wobble">
										<div></div>
										<span>抖动</span>
									</li>
									<li data-class="rotateIn">
										<div></div>
										<span>旋转</span>
									</li>
									<li data-class="flash">
										<div></div>
										<span>闪烁</span>
									</li>
									<li data-class="jello">
										<div></div>
										<span>倾斜抖动</span>
									</li>
									<li data-class="jackInTheBox">
										<div></div>
										<span>放大抖动</span>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="showPage">
			<div class="settingBg"></div>
			<div class="leftCon">
				<div class="showPhoneBg">
					<div class="showPhoneBox">
						<div class="swiper-containerBox">
							<div id="audio_btn">
								<audio src="" id="media"></audio>
							</div>
							<div class="swiper-wrapper">
							</div>
							<img src="images/arrow.png" style="width:20px;height:15px; bottom:1%; left:48%;" id="array" class="resize">
							<div class="swiper-pagination"></div>
						</div>
						<!--<div class="swiper-button-prev">上一页</div>
						<div class="swiper-button-next">下一页</div>-->
					</div>
				</div>
				<img id="closeShowPage" src="images/cha.png" />
			</div>
		</div>

		<div id="musicTong" style="display: none; overflow-y: hidden;">
			<div class="left">
				<dl>
					<dt><span>音乐库</span><i class="icon iconfont icon-yinlemusic216"></i></dt>
					<dd class="active">我的音乐</dd>
				</dl>
				<div class="uploadMu">
					<button type="button" class="layui-btn" id="uploadM"><i class="layui-icon"></i>上传音频</button>
					<i class="icon iconfont icon-question" id="question-id" onmouseover="question('question-id')"></i>
				</div>
			</div>
			<div class="right">
				<ul class="musicList">
					<li class="cc">
						<span data-music="music/pfzl.mp3" class="nameM">dsfs.mp3</span>
						<span class="removeM"><i class="icon iconfont icon-shanchu"></i></span>
					</li>
					<li class="cc">
						<span data-music="music/SoulJa - Shine.mp3" class="nameM">SoulJa - Shine.mp3</span>
						<span class="removeM"><i class="icon iconfont icon-shanchu"></i></span>
					</li>
				</ul>
				<div class="music-foot">
					<span class="nomusic">无音乐</span>
					<div class="info">
						<span id="musicname" class="name"></span>
						<div class="detail">
							<audio src="" id="audio" controls="controls"></audio>
						</div>
					</div>
					<div class="submit" id="enterMusic">
						确定
					</div>
					<div class="clear" id="clearMusic">
						<i class="icon iconfont icon-yinlemusic216"></i> 删除默认音乐
					</div>
				</div>
			</div>
		</div>

		<div id="coverTong" style="display: none;">
			<div class="basic-info">
				<div class="left">
					<span>更换封面<input id="coverbg" type="file" /></span>
				</div>
				<div class="right">
					<form class="layui-form" action="">
						<div class="layui-form-item">
							<label class="layui-form-label">分类</label>
							<div class="layui-input-block">
								<select name="modules" lay-verify="required" lay-search="">
									<option value="">选择模板分类</option>
									<option value="1">邀请函</option>
									<option value="2">企业宣传</option>
									<option value="3">企业招聘</option>
									<option value="4">活动促销</option>
									<option value="5">教育培训</option>
									<option value="6">个人请柬</option>
									<option value="7">音乐相册</option>
									<option value="8">热门行业</option>
									<option value="9">热门风格</option>
									<option value="10">热门节假</option>
								</select>
							</div>
						</div>
						<div class="layui-form-item">
							<label class="layui-form-label">标题</label>
							<div class="layui-input-block">
								<input type="text" name="title" lay-verify="title" autocomplete="off" placeholder="未命名场景" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item layui-form-text">
							<label id="cover_title" class="layui-form-label">描述</label>
							<div class="layui-input-block">
								<textarea id="cover_desc" placeholder="我做了一个酷炫的H5,快来看看吧。" class="layui-textarea"></textarea>
							</div>
						</div>
						<div class="layui-form-item">
							<div class="layui-input-block">
								<button class="layui-btn" lay-submit="" lay-filter="demo1">立即提交</button>
								<button type="reset" class="layui-btn layui-btn-primary">重置</button>
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>
		<script src="js/jquery-2.1.4.min.js"></script>
		<script src="layui/layui.js"></script>
		<script src="layer/layer.js"></script>
		<script src="dist/js/swiper.min.js"></script>
		<script src="js/swiper.animate.min.js"></script>
		<script charset="utf-8" src="https://map.qq.com/api/js?v=2.exp&key=4Y5BZ-YAPK6-H43SC-M76DE-6W7PO-EUF5B"></script>
		<script src="js/js.js"></script>
		<script>
			//定义好触发事件
			var handleStart = "mousedown"
			var handleMove = "mousemove"
			var handleEnd = "mouseup"
			//定义一些全局变量
			var initTouchX = 0;
			var initTouchY = 0;
			var initDomLeft = 0;
			var initDomTop = 0;
			var initDomWidth = 0;
			var isTouch = false;
			var maplat, maplng, mapplace;
			var clientVal = document.documentElement.clientHeight;
			var headVal = $(".layui-header").height();
			var topVal = $(".creat_head").height();
			var contentVal = $(".layui-body").width();
			var canvasValW = contentVal - 304;
			var clientH = clientVal - topVal - headVal;
			$(".operationBox").css("height", clientH);
			$(".canvasBox").css("width", canvasValW);
			$(".canvasBox").css("height", clientH);

			$(".rightSet li").click(function() {
				$(this).addClass('on').siblings().removeClass('on');
				var m = $(this).index();
				$(".rightSetBox").eq(m).show().siblings('.rightSetBox').hide();
			})

			//对swiper的所有元素绑定事件
			$(document).on(handleStart, ".phoneBox .swiper-slide span", function(e) {
				e.preventDefault();
				$(this).addClass("animated choseBorder").siblings().removeClass("choseBorder");
				$(this).parent().siblings().find("span").removeClass("choseBorder");
				$("span p").attr("contenteditable", "true");
				var client = getClient(e);
				isTouch = true
				initTouchX = client.x
				initTouchY = client.y
				initDomLeft = parseInt($(this).css("left"));
				initDomTop = parseInt($(this).css("top"));
				initDomWidth = parseInt($(this).width());
			})
			//复位所有元素绑定事件
			$(".phoneBox .swiper-slide").on(handleStart, function() {
				$(this).find("span").removeClass("choseBorder");
				$(this).find("span p").attr("contenteditable", "false");
				$(".style_list_img").css("display", "none");
				$(".style_list_map").css("display", "none");
			})
			$(".canvasBox").on(handleStart, function() {
				$(".swiper-slide span").removeClass("choseBorder");
				$(".swiper-slide span p").attr("contenteditable", "false");
			})
			//对swiper的所有元素移动事件
			setTimeout(function() {
				$(document).on(handleMove, ".phoneBox span.choseBorder", function(e) {
					$(".phoneBox").addClass("swiper-no-swiping");
					e.preventDefault();
					if(!isTouch) {
						return
					}
					var client = getClient(e)
					var moveX = client.x
					var moveY = client.y
					//console.log(initDomLeft+moveX-initTouchX)
					var lefval = (initDomLeft + moveX - initTouchX);
					var topval = (initDomTop + moveY - initTouchY);
					$(this).css({
						"left": lefval,
						"top": topval
					})
				})
			}, 50)
			//触摸结束
			$(document).mouseup(function(event) {
				$(".phoneBox").removeClass("swiper-no-swiping");
				isTouch = false
			})
			//对swiper的所有元素宽度的拖动
			setTimeout(function() {
				$(document).on(handleMove, ".phoneBox span.choseBorder i.moveElement", function(e) {
					$(".phoneBox").addClass("swiper-no-swiping");
					e.stopPropagation()
					if(!isTouch) {
						return
					}
					var client = getClient(e);
					var moveX = client.x;
					var moveY = client.y;
					$(".phoneBox .swiper-slide span img").css("width", "100%");
					$(this).parent().css("width", initDomWidth + moveX - initTouchX - 2 + "px");
					$(".phoneBox span.choseBorder #mapcontent").css("width", initDomWidth + moveX - initTouchX - 4 + "px");
					$(".phoneBox span.choseBorder #mapcontent").css("height", initDomWidth + moveX - initTouchX - 4 + "px");
				})
			}, 50)

			//获取触摸坐标
			function getClient(e) {
				var evt = handleMove == "mousemove" ? e : e.originalEvent.targetTouches[0]
				return {
					x: evt.clientX,
					y: evt.clientY
				}
			}

			//删除组件
			setTimeout(function() {
				$(document).on('click', ".phoneBox span i.deleteElement", function(e) {
					e.stopPropagation();
					$(this).parent().remove()
				})
			}, 50)
			//键盘Delete事件
			document.onkeydown = function(event) {
				$("#Fileimg").val("");
				var e = event || window.event || arguments.callee.caller.arguments[0];
				if(e && e.keyCode == 46) { // 按 Esc
					$(".phoneBox .choseBorder").parents("li").remove();
					$(".phoneBox .choseBorder").remove();
					if(".phoneBox .choseBorder #mapcontent") {
						$(".phoneBox .style_list_map").css("display", "none")
					}
				}
			};

			function txtLFn(id) {
				layer.tips("居左", "#" + id + "", {
					tips: [3, "#4c546a"],
				});
			}

			function txtCFn(id) {
				layer.tips("居中", "#" + id + "", {
					tips: [3, "#4c546a"],
				});
			}

			function txtRFn(id) {
				layer.tips("居右", "#" + id + "", {
					tips: [3, "#4c546a"],
				});
			}

			function txtFontStyleFn(id) {
				layer.tips("倾斜", "#" + id + "", {
					tips: [3, "#4c546a"],
				});
			}

			function txtBoldFn(id) {
				layer.tips("加粗", "#" + id + "", {
					tips: [3, "#4c546a"],
				});
			}

			function txtFontStyleFn(id) {
				layer.tips("倾斜", "#" + id + "", {
					tips: [3, "#4c546a"],
				});
			}

			function txtLineFn(id) {
				layer.tips("下划线", "#" + id + "", {
					tips: [3, "#4c546a"],
				});
			}

			function txtClearFn(id) {
				layer.tips("清楚样式", "#" + id + "", {
					tips: [3, "#4c546a"],
				});
			}

			function question(id) {
				layer.tips("上传须知 </br>通过本地电脑上传音乐，大小不超过10M，支持格式：MP3。", "#" + id + "", {
					tips: [2, "#4c546a"],
				});
			}

			//上传图片
			$("#Fileimg").change(function() {
				$(".phoneBox .swiper-slide span").removeClass("choseBorder");
				var imgFile = $(this)[0].files[0];
				if((imgFile.type).indexOf("image/") == -1) { 
					layer.msg("请上传图片!");
				}
				var reader = new FileReader()
				reader.readAsDataURL(imgFile);
				reader.onload = function(e) {
					var base64 = e.target.result;
					var imgDom = '<span contenteditable="false" class="choseBorder" style="left: 0px; top:0px;"><img onclick="bandImg(this)" onload="changeImg(this);" alt="" src="' + base64 + '"/><i class="moveElement"></i><i class="deleteElement"></i></span>';
					$(".phoneBox .swiper-slide-active").append(imgDom);
					$("#Fileimg").val("");
				}
			})

			//更换图片
			function bandImg(e) {
				var src = e.src;
				$(".image-preview").css("background-image", "url(" + src + ")")
				$(".style_list_img").css("display", "block");
			}
			$("#changeImgUrl_Id").change(function() {
				var changeImgUrl_Id = $(this)[0].files[0];
				if((changeImgUrl_Id.type).indexOf("image/") == -1) { 
					layer.msg("请上传图片!");
				}
				var reader = new FileReader()
				reader.readAsDataURL(changeImgUrl_Id);
				reader.onload = function(e) {
					var base64 = e.target.result;
					$(".choseBorder img").attr("src", base64);
					$(".image-preview").css("background-image", "url(" + base64 + ")")
				}
			})

			function changeImg(objImg) {
				var most = 320; //设置最大宽度
				if(objImg.width > most) {
					var scaling = 1 - (objImg.width - most) / objImg.width;
					objImg.width = objImg.width * scaling;
				}
			}
			//上传背景图片
			$("#Filebg").change(function() {
				var imgFile = $(this)[0].files[0];
				if((imgFile.type).indexOf("image/") == -1) { 
					layer.msg("请上传图片!");
					return
				}
				var reader = new FileReader()
				reader.readAsDataURL(imgFile);
				reader.onload = function(e) {
					var base64 = e.target.result;
					$(".swiper-slide-active").css("background-image", "url(" + base64 + ")");
					$("#Filebg").val("");
				}
			})
			//删除背景图
			function removeBgimg() {
				$(".swiper-slide-active").css("background-image", "none");
				$("#Filebg").val('')
			}
			//上传封面图
			$("#coverbg").change(function() {
				var imgFile = $(this)[0].files[0]
				if((imgFile.type).indexOf("image/") == -1) { 
					layer.msg("请上传图片!");
					return
				}
				var reader = new FileReader()
				reader.readAsDataURL(imgFile);
				reader.onload = function(e) {
					var base64 = e.target.result;
					$("#coverTong .basic-info .left").css("background-image", "url(" + base64 + ")");
				}
			})

			//新增空白页
			function addPage() {
				var pageDom = "<section class='swiper-slide'></section>";
				$(".phoneBox .swiper-wrapper").append(pageDom)
			}

			//背景和表单切换
			$('.creat_con>ul li').mousemove(function() {
				$(this).find('dl.navBox').show();
			});
			$('.creat_con>ul li').mouseleave(function() {
				$(this).find('dl.navBox').hide();
			});

			//添加地图
			var geocoder, map2, marker = null,
				markersArray = [];

			function init(xLight, yLight, place) {
				var center = new qq.maps.LatLng(xLight, yLight);
				var map = new qq.maps.Map(document.getElementById('mapcontent'), {
					center: center,
					zoom: 12,
					zoomControl: false, //放大缩小控件
					panControl: false, //平移控件
					draggable: false, //设置是否可以拖拽
					scrollwheel: false, //设置是否可以滚动
					disableDoubleClickZoom: true, //设置是否可以双击放大
					disableDefaultUI: true //禁止所有控件
				});

				var label = new qq.maps.Label({
					position: center,
					map: map,
					content: place
				});
				var marker = new qq.maps.Marker({
					position: center,
					map: map
				});
			}

			function inits(xLight, yLight, place) {
				var center = new qq.maps.LatLng(xLight, yLight);
				map2 = new qq.maps.Map(document.getElementById('mapcontainer'), {
					center: center,
					zoom: 12
				});
				geocoder = new qq.maps.Geocoder();
			}

			function initshow(xLight, yLight, place) {
				var center = new qq.maps.LatLng(xLight, yLight);
				var map = new qq.maps.Map(document.getElementById('mapshowcontent'), {
					center: center,
					zoom: 12,
					zoomControl: false, //放大缩小控件
					panControl: false, //平移控件
					draggable: true, //设置是否可以拖拽
					scrollwheel: false, //设置是否可以滚动
				});
				var label = new qq.maps.Label({
					position: center,
					map: map,
					content: place
				});
				var markerid = new qq.maps.Marker({
					position: center,
					map: map
				});
			}

			//清除覆盖层
			function clearOverlays() {
				if(markersArray) {
					for(i in markersArray) {
						markersArray[i].setMap(null);
					}
				}
			}

			function codeAddress() {
				clearOverlays();
				var address = document.getElementById("address").value;
				geocoder.getLocation(address);
				geocoder.setComplete(function(result) {
					map2.setCenter(result.detail.location);
					var marker = new qq.maps.Marker({
						map: map2,
						position: result.detail.location
					});
					markersArray.push(marker);
					var lontVal = result.detail.location;
					//调取传给模板里的地图经纬度
					maplat = lontVal.lat;
					maplng = lontVal.lng;
					mapplace = address;
					init(lontVal.lat, lontVal.lng, address);
				});
				geocoder.setError(function() {
					layer.msg("请输入正确的地址!");
				});
			}

			function addMap() {
				if($(".phoneBox #mapcontent").length !== 0) {
					layer.alert('当前模板地图模块已存在，请不要重复添加。', {
						title: '提示',
						icon: 3,
						skin: 'layer-ext-moon' //该皮肤由layer.seaning.com友情扩展。关于皮肤的扩展规则，去这里查阅
					})
				} else {
					var mapDom = "<span class='rightMap' style='left:25%;top:142px'><div onclick='showMap(this)' id='mapcontent'></div><i class='moveElement'></i><i class='deleteElement'></span>";
					$(".swiper-slide-active").append(mapDom);
					//调用初始化函数地图
					init(39.916527, 116.397128, '北京');
					inits(39.916527, 116.397128, '北京');
				}

			}

			function showMap() {
				$(".style_list_map").css("display", "block");
			}
			//插入表单
			function formidA() {
				if($("ul#edit_area li #formButton").length) {
					layer.alert('当前模板表单模块已存在，请不要重复添加。', {
						title: '提示',
						icon: 3,
						skin: 'layer-ext-moon' //该皮肤由layer.seaning.com友情扩展。关于皮肤的扩展规则，去这里查阅
					})
				} else {
					if($("ul#edit_area").length !== 0) {
						var formDom = '<li><span><input name="name" type="text" placeholder="姓名" /><i class="moveElement"></i><i class="deleteElement"></i></span></li><li><span><input name="tell" type="text" placeholder="电话" /><i class="moveElement"></i><i class="deleteElement"></i></span></li><li><span><input name="mail" type="text" placeholder="邮箱" /><i class="moveElement"></i><i class="deleteElement"></i></span></li><li><span><button id="formButton" type="button">提交</button><i class="moveElement"></i><i class="deleteElement"></i></span></li>';
						$(".phoneBox .swiper-slide-active ul#edit_area").append(formDom)
					} else {
						var formWrap = '<ul id="edit_area"></ul>';
						$(".phoneBox .swiper-slide-active").append(formWrap);
						var formDom = '<li><span><input name="name" type="text" placeholder="姓名" /><i class="moveElement"></i><i class="deleteElement"></i></span></li><li><span><input name="tell" type="text" placeholder="电话" /><i class="moveElement"></i><i class="deleteElement"></i></span></li><li><span><input name="mail" type="text" placeholder="邮箱" /><i class="moveElement"></i><i class="deleteElement"></i></span></li><li><span><button id="formButton" type="button">提交</button><i class="moveElement"></i><i class="deleteElement"></i></span></li>';
						$(".phoneBox .swiper-slide-active ul#edit_area").append(formDom)
					}
				}
			}

			function formidB() {
				if($("ul#edit_area li#textareaId").length == 1) {
					layer.alert('当前模板表单模块已存在，请不要重复添加。', {
						icon: 3,
						skin: 'layer-ext-moon' //该皮肤由layer.seaning.com友情扩展。关于皮肤的扩展规则，去这里查阅
					})
				} else {
					if($("ul#edit_area").length !== 0) {
						var formTextarea = '<li style="height: 85px" id="textareaId"><span><textarea placeholder="文本"></textarea><i class="moveElement"></i><i class="deleteElement"></i></span></li>';
						$(".phoneBox .swiper-slide-active ul#edit_area").append(formTextarea)
					} else {
						var formWrap = '<ul id="edit_area"></ul>';
						$(".phoneBox .swiper-slide-active").append(formWrap);
						var formTextarea = '<li style="height: 85px" id="textareaId"><span><textarea placeholder="文本"></textarea><i class="moveElement"></i><i class="deleteElement"></i></span></li>';
						$(".phoneBox .swiper-slide-active ul#edit_area").append(formTextarea)
					}
				}
			}
			//插入音乐
			function addMusic() {
				layer.open({
					type: 1,
					title: false,
					skin: 'layui-layer-rim', //加上边框
					area: ['960px', '600px'], //宽高
					content: $('#musicTong')
				});
			}

			//选择封面
			function addCover() {
				layer.open({
					type: 1,
					title: "封面设置",
					skin: 'layui-layer-rim', //加上边框
					area: ['960px', '600px'], //宽高
					content: $('#coverTong')
				});
			}

			//自定义鼠标右键事件
			window.onload = function() {
				var el = document.getElementById("tar");
				var oMenu = document.getElementById("menu");
				el.oncontextmenu = function(e) {
					if(e.button == 2) {
						e.preventDefault();
						oMenu.style.display = "block";
						oMenu.style.left = e.offsetX + "px";
						oMenu.style.top = e.offsetY + "px";
					}
				}
				$('#menu').mouseleave(function() {
					oMenu.style.display = "none";
				});
				document.getElementById("btn1").onmousedown = function(e) {
					e.stopPropagation();
					$("#Fileimg").val("");
					$(".phoneBox span.choseBorder").remove();
					$(".phoneBox .choseBorder").parents("li").remove();
					oMenu.style.display = "none";
				}
				document.getElementById("btn2").onmousedown = function(e) {
					e.stopPropagation();
					$(".phoneBox span.choseBorder").css("z-index", "12");
					$(".phoneBox span.choseBorder").parent("li").css("z-index", "12");
					oMenu.style.display = "none";
				}
				document.getElementById("btn3").onmousedown = function(e) {
					e.stopPropagation();
					$(".phoneBox span.choseBorder").css("z-index", "1");
					$(".phoneBox span.choseBorder").parent("li").css("z-index", "1");
					oMenu.style.display = "none";
				}
				document.getElementById("btn4").onmousedown = function(e) {
					e.stopPropagation();
					var zVal = parseInt($("span.choseBorder").css("z-index"));
					$(".phoneBox span.choseBorder").css("z-index", zVal + 1);
					$(".phoneBox span.choseBorder").parent("li").css("z-index", zVal + 1);
					oMenu.style.display = "none";
				}
				document.getElementById("btn5").onmousedown = function(e) {
					e.stopPropagation();
					var zVal = parseInt($("span.choseBorder").css("z-index"));
					$(".phoneBox span.choseBorder").css("z-index", zVal - 1);
					$(".phoneBox span.choseBorder").parent("li").css("z-index", zVal - 1);
					oMenu.style.display = "none";
				}
				return false;
			}

			//保存模板
			var saveArry = new Array();
			$("#saveFn").on('click', function() {
				saveArry.splice(0, saveArry.length);
				$(".phoneBox .swiper-slide span").removeClass("choseBorder");
				if($("ul#edit_area li").length == 0) {
					$("ul#edit_area").remove();
				}
				$.each($(".swiper-wrapper .swiper-slide"), function(i, t) {
					var obj = {};
					//如果没有背景图和背景色不插入数组
					if($(t).css("background") == "rgba(0, 0, 0, 0) none no-repeat scroll 50% 50% / cover padding-box border-box") {
						obj.backgroundCon = "";
					} else {
						obj.backgroundCon = $(t).css("background");
					}
					//如果保存的有地图组件传经纬度和地点插入数组
					if($(t).html().indexOf('rightMap') !== -1) {
						var mapWith = $("#mapcontent").width();
						obj.content = ""; //这里要传入地图的数据给小程序端用
					} else {
						obj.content = $(t).html();
					}
					saveArry.push(obj)
				});
				console.log((saveArry))
			})
			//预览模板
			function showModel() {
				$(".phoneBox .swiper-slide span").removeClass("choseBorder");
				if($("ul#edit_area li").length == 0) {
					$("ul#edit_area").remove();
				}
				var domHtml = $(".phoneBox .swiper-container .swiper-wrapper").html();
				
				var wVal = $(".phoneBox span.choseBorder #mapcontent").width() + 'px';
				$(".swiper-containerBox .swiper-wrapper").html('');
				$(".swiper-containerBox .swiper-wrapper").append(domHtml);
				if($(".showPhoneBox .swiper-slide span").hasClass("rightMap")) {
					$(".showPhoneBox span.rightMap div").remove();
					var mapDom = "<div id='mapshowcontent' style='width: " + wVal + ";height:" + wVal + "'></div>";
					$(".showPhoneBox span.rightMap").append(mapDom);
					if(maplat == undefined) {
						initshow(39.916527, 116.397128, '北京');
					} else {
						initshow(maplat, maplng, mapplace);
					}
				}
				$(".showPage").css("display", "block");
				var mySwiper = new Swiper('.swiper-containerBox', {
					/*prevButton: '.swiper-button-prev',
					nextButton: '.swiper-button-next',*/
					pagination: '.swiper-pagination',
					paginationType: 'fraction',
					direction: 'vertical',
					slidesPerView: 1,
					paginationClickable: true,
					mousewheelControl: true,
					observer: true,
					observeParents: false,
					onInit: function(swiper) {
						swiperAnimateCache(swiper);
						swiperAnimate(swiper);
					},
					onSlideChangeEnd: function(swiper) {
						swiperAnimate(swiper);
					},
					onTransitionEnd: function(swiper) {
						swiperAnimate(swiper);
					}

				});
				//播放音乐
				var myVideo = document.getElementById("media");
				if($("#media").attr("src")) {
					myVideo.play();
					$("#audio_btn").addClass("rotate");
				} else {
					myVideo.pause();
				}
				$("#audio_btn").click(function() {
					$(this).toggleClass("rotate"); //控制音乐图标 自转或暂停
					if($(this).hasClass("rotate")) {
						myVideo.play();
					} else {
						$(this).removeClass("rotate");
						myVideo.pause();
					}
				})
				$(".showPhoneBox #formButton").on('click', function() {
					var name = $(".showPhoneBox #edit_area li input[name=name]").val();
					var tell = $(".showPhoneBox #edit_area li input[name=tell]").val();
					var mail = $(".showPhoneBox #edit_area li input[name=mail]").val();
					layer.msg("谢谢您的参与!")
					//ajax
				})
			}
		</script>
	</body>

</html>